{
	"name": "Home Ops",
	"image": "mcr.microsoft.com/devcontainers/base:debian",
	"containerEnv": {
		"KUBECONFIG": "${containerWorkspaceFolder}/kubeconfig",
		"SOPS_AGE_KEY_FILE": "${containerWorkspaceFolder}/.age.key"
	},
	"postCreateCommand": {
		// Install additional python dependencies for ansible
		"deps": "task deps"
	},
	"features": {
		// Upgrade OS packages
		"ghcr.io/devcontainers/features/common-utils:2": {
			"version": "latest",
			"installZsh": false,
			"installOhMyZsh": false
		},
		// Install go-task
		"ghcr.io/devcontainers-contrib/features/go-task:1": {
			"version": "3.31.0"
		},
		// Install python and ansible
		// Not using the python feature because it includes vscode extentions and we don't want that.
		//  See https://github.com/devcontainers/features/blob/d53b9d1816bac7a62f9ba5f20723eef428042d1f/src/python/devcontainer-feature.json#L64
		//  One day disable with https://github.com/devcontainers/features/issues/386
		"ghcr.io/devcontainers-contrib/features/ansible:2": {
			"version": "2.16.0"
		},
		// Install age
		"ghcr.io/devcontainers-contrib/features/age:1": {
			"version": "1.1.0-rc.1"
		},
		// Install cilium-cli
		"ghcr.io/audacioustux/devcontainers/cilium:1": {},
		// Install cloudflared
		"ghcr.io/devcontainers-contrib/features/cloudflared:1": {
			"version": "2021.10.0"
		},
		// Install flux-cli
		"ghcr.io/jsburckhardt/devcontainer-features/flux:1": {
			"version": "v2.1.2"
		},
		// Install kubectl and helm
		"ghcr.io/devcontainers/features/kubectl-helm-minikube:1": {
			"version": "1.28.3",
			"helm": "latest",
			"minikube": "none"
		},
		// Install kustomize
		"ghcr.io/rio/features/kustomize:1": {
			"version": "latest"
		},
		// Install sops
		"ghcr.io/devcontainers-contrib/features/sops:1": {
			"version": "3.7.3"
		},
		// Install stern
		"ghcr.io/dhoeric/features/stern:1": {
			"version": "1.27.0"
		},
		// Install jq
		"ghcr.io/eitsupi/devcontainer-features/jq-likes:2": {
			"jqVersion": "1.7"
		}
	},
	"customizations": {
		"vscode": {
			"settings": {
				"terminal.integrated.profiles.linux": {
					"bash": {
						"path": "/bin/bash"
					}
				},
				"terminal.integrated.defaultProfile.linux": "bash"
			},
			"extensions": [
				"albert.TabOut",
				"britesnow.vscode-toggle-quotes",
				"EditorConfig.editorconfig",
				"fcrespo82.markdown-table-formatter",
				"GitHub.copilot",
				"mikestead.dotenv",
				"mitchdenny.ecdc",
				"PKief.material-icon-theme",
				"redhat.ansible",
				"signageos.signageos-vscode-sops",
				"task.vscode-task",
				"VisualStudioExptTeam.vscodeintellicode",
				"will-stone.in-any-case"
			]
		}
	}
}