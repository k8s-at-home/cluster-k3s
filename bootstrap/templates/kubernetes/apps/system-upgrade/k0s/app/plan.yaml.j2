---
apiVersion: autopilot.k0sproject.io/v1beta2
kind: Plan
metadata:
  name: controller-worker
spec:
  commands:
    - k0supdate:
        version: "${KUBE_VERSION}"
        platforms:
          linux-amd64:
            url: "https://get.k0sproject.io/${KUBE_VERSION}/k0s-${KUBE_VERSION}-amd64"
        targets:
          controllers:
            discovery:
              selector:
                labels: kubernetes.io/arch=amd64
          workers:
            discovery:
              selector:
                labels: kubernetes.io/arch=amd64
    - k0supdate:
        version: "${KUBE_VERSION}"
        platforms:
          linux-arm64:
            url: "https://get.k0sproject.io/${KUBE_VERSION}/k0s-${KUBE_VERSION}-arm64"
        targets:
          controllers:
            discovery:
              selector:
                labels: kubernetes.io/arch=arm64
          workers:
            discovery:
              selector:
                labels: kubernetes.io/arch=arm64
    - k0supdate:
        version: "${KUBE_VERSION}"
        platforms:
          linux-arm:
            url: "https://get.k0sproject.io/${KUBE_VERSION}/k0s-${KUBE_VERSION}-arm"
        targets:
          controllers:
            discovery:
              selector:
                labels: kubernetes.io/arch=arm
          workers:
            discovery:
              selector:
                labels: kubernetes.io/arch=arm
